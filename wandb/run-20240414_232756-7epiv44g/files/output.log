Files already downloaded and verified
Files already downloaded and verified
  0%|          | 0/100 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "train_from_pretrain.py", line 184, in <module>
    main(args)
  File "train_from_pretrain.py", line 180, in main
    training_validating_testing(args, classifier, criterion, optimizer, trainloader, valloader, testloader)
  File "train_from_pretrain.py", line 67, in training_validating_testing
    outputs = classifier(images)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data0/user/gsli/Classifiers-enhanced-by-pre-training/model.py", line 22, in forward
    embedding = self.encoder(x)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data0/user/gsli/Classifiers-enhanced-by-pre-training/clip/model.py", line 232, in forward
    x = self.transformer(x)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data0/user/gsli/Classifiers-enhanced-by-pre-training/clip/model.py", line 203, in forward
    return self.resblocks(x)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data0/user/gsli/Classifiers-enhanced-by-pre-training/clip/model.py", line 190, in forward
    x = x + self.attention(self.ln_1(x))
  File "/data0/user/gsli/Classifiers-enhanced-by-pre-training/clip/model.py", line 187, in attention
    return self.attn(x, x, x, need_weights=False, attn_mask=self.attn_mask)[0]
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 1241, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/functional.py", line 5300, in multi_head_attention_forward
    q, k, v = _in_projection_packed(query, key, value, in_proj_weight, in_proj_bias)
  File "/data0/user/gsli/.conda/envs/test/lib/python3.8/site-packages/torch/nn/functional.py", line 4826, in _in_projection_packed
    proj = proj.unflatten(-1, (3, E)).unsqueeze(0).transpose(0, -2).squeeze(-2).contiguous()
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 450.00 MiB. GPU 0 has a total capacty of 44.42 GiB of which 390.25 MiB is free. Process 2214709 has 4.77 GiB memory in use. Process 2216305 has 4.82 GiB memory in use. Including non-PyTorch memory, this process has 34.45 GiB memory in use. Of the allocated memory 32.75 GiB is allocated by PyTorch, and 322.11 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF